<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <meta property="og:title" content="SYNAPSE ON : ì‚¬ë‘ì˜ ë²ˆì—­ê¸°">
    <meta property="og:description" content="ì„œë¡œì˜ ë§ˆìŒì„ ê°€ì¥ ê¹Šê²Œ ì´í•´í•˜ê¸° ìœ„í•œ 30ê°€ì§€ ê°ê° ì§ˆë¬¸.">
    <meta property="og:image" content="https://images.unsplash.com/photo-1620641788421-7a1c342ea42e?q=80&w=1000&auto=format&fit=crop">
    <meta property="og:type" content="website">

    <title>ì‹œëƒ…ìŠ¤ ì˜¨ : [SYNAPSE ON]</title>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* [DESIGN SYSTEM: Deep Love & Neon Tech] */
        :root { 
            --bg: #050508; --card: #0f0f13; 
            --accent: #00f2ff; /* Cyan: ì´ì„±/ë¶„ì„ */
            --love: #ff0055;   /* Pink: ì‚¬ë‘/ê¸ˆê¸° */
            --kakao: #FEE500;  /* Kakao Yellow */
            --text: #f1f5f9; --sub: #64748b; --border: #1a1a25; 
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; font-family: 'Pretendard', -apple-system, sans-serif; }
        body { 
            background: var(--bg); color: var(--text); line-height: 1.6; word-break: keep-all; 
            background-image: radial-gradient(circle at 50% 50%, rgba(0, 242, 255, 0.03) 0%, transparent 50%);
        }
        
        .app { max-width: 480px; margin: 0 auto; min-height: 100vh; display: none; flex-direction: column; background: rgba(5, 5, 8, 0.98); border-left: 1px solid var(--border); border-right: 1px solid var(--border); position: relative; animation: fadeIn 0.5s ease-out; }
        .app.active { display: flex !important; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Typography */
        header { text-align: center; padding: 40px 20px 20px; }
        .logo { font-size: 1.1rem; font-weight: 900; color: var(--accent); letter-spacing: 4px; margin-bottom: 10px; display: block; }
        h1 { font-size: 1.5rem; font-weight: 800; margin-bottom: 10px; background: linear-gradient(to right, #fff, #94a3b8); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .desc { font-size: 0.9rem; color: var(--sub); line-height: 1.6; margin-bottom: 30px; }

        /* [MAGIC BUTTONS] ì „ì†¡ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn-kakao {
            background: var(--kakao); color: #000; border: none; width: 100%; padding: 18px; 
            font-size: 1rem; font-weight: 800; border-radius: 12px; cursor: pointer; 
            display: flex; align-items: center; justify-content: center; gap: 10px;
            box-shadow: 0 4px 15px rgba(254, 229, 0, 0.3); transition: transform 0.2s; margin-top: 15px;
        }
        .btn-kakao:active { transform: scale(0.96); }
        .btn-kakao::before { content: 'ğŸ’¬'; font-size: 1.2rem; }

        .btn-main { 
            background: var(--accent); color: #000; border: none; width: 100%; padding: 18px; 
            font-size: 1.1rem; font-weight: 800; border-radius: 12px; cursor: pointer; 
            box-shadow: 0 0 20px rgba(0, 242, 255, 0.3); transition: 0.2s; margin-top: 20px;
        }

        /* [ANALYSIS INFO] ë¶„ì„ ë°©ë²• ì†Œê°œ ì¹´ë“œ */
        .info-card { background: var(--card); border: 1px solid var(--border); border-radius: 16px; padding: 25px; margin-bottom: 20px; text-align: left; }
        .info-tag { font-size: 0.75rem; color: var(--accent); border: 1px solid var(--accent); padding: 4px 8px; border-radius: 20px; margin-bottom: 10px; display: inline-block; }
        .info-title { font-size: 1.1rem; font-weight: 700; margin-bottom: 8px; color: #fff; }
        .info-text { font-size: 0.9rem; color: var(--sub); line-height: 1.7; }

        /* [REPORT UI] 5-5-5 & Thermometer */
        .zone-box { margin-bottom: 30px; border: 1px solid var(--border); border-radius: 16px; padding: 20px; background: rgba(255,255,255,0.02); }
        .zone-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid var(--border); }
        .z-title { font-weight: 800; font-size: 1.1rem; }
        .green { color: var(--accent); }
        .red { color: var(--love); }
        
        .item-row { margin-bottom: 15px; }
        .item-head { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
        .item-keyword { font-size: 0.9rem; font-weight: 700; color: #fff; }
        .thermo { font-size: 0.8rem; letter-spacing: 1px; }
        .t-high { color: var(--love); } .t-med { color: var(--accent); }
        
        .action-text { font-size: 0.9rem; color: #ccc; margin-bottom: 8px; line-height: 1.5; }
        .msg-box { background: #1a1a20; padding: 10px 15px; border-radius: 8px; font-size: 0.85rem; color: var(--sub); border-left: 2px solid #333; cursor: pointer; }
        .msg-box:active { background: #222; color: #fff; }

        /* [SURVEY UI] */
        .opt-btn { width: 100%; padding: 18px; margin-bottom: 10px; background: #0f0f15; border: 1px solid var(--border); color: #ccc; border-radius: 12px; text-align: left; transition: 0.2s; }
        .opt-btn:active { background: var(--accent); color: #000; font-weight: 700; }
        .progress-bar { height: 3px; background: #111; width: 100%; }
        .progress-fill { height: 100%; background: var(--accent); width: 0%; transition: width 0.3s; }

    </style>
</head>
<body>

<div class="app" id="v-landing">
    <header>
        <span class="logo">SYNAPSE ON</span>
        <h1>ì‚¬ë‘ì—ë„<br>ë²ˆì—­ê¸°ê°€ í•„ìš”í•©ë‹ˆë‹¤</h1>
        <p class="desc">ì˜¤í•´í•˜ì§€ ì•Šê³ , ìƒì²˜ ì£¼ì§€ ì•Šê³ <br>ì„œë¡œë¥¼ ê°€ì¥ ê¹Šì´ ì•„ê»´ì£¼ëŠ” ê³¼í•™ì  ë°©ë²•</p>
    </header>

    <div style="padding: 0 20px 40px;">
        <div class="info-card">
            <span class="info-tag">METHODOLOGY</span>
            <div class="info-title">1. ê°ê° ìš°íšŒ ì„¤ê³„ (Sensory Bypass)</div>
            <p class="info-text">"ì‚¬ë‘í•´?"ë¼ê³  ë¬»ì§€ ì•ŠìŠµë‹ˆë‹¤. ë¹›, ì†Œë¦¬, ê³µê°„ì— ëŒ€í•œ 30ê°€ì§€ ë¬´ì˜ì‹ ë°˜ì‘ì„ í†µí•´ ì´ì„±ì´ ì•„ë‹Œ ë³¸ëŠ¥ì  ì• ì°© ìœ í˜•ì„ ë¶„ì„í•©ë‹ˆë‹¤.</p>
        </div>
        <div class="info-card">
            <span class="info-tag">NEUROSCIENCE</span>
            <div class="info-title">2. ì‹ ê²½ê³„ ì•ˆì • (Polyvagal Theory)</div>
            <p class="info-text">ìƒëŒ€ê°€ ì–¸ì œ 'ì•ˆì „í•¨'ì„ ëŠë¼ê³  ì–¸ì œ 'ê³µí¬'ë¥¼ ëŠë¼ëŠ”ì§€, ë‹¤ë¯¸ì£¼ ì‹ ê²½ ì´ë¡ ì— ê¸°ë°˜í•˜ì—¬ ì‹ ê²½ê³„ë¥¼ ì•ˆì •ì‹œí‚¤ëŠ” í–‰ë™ì„ ì²˜ë°©í•©ë‹ˆë‹¤.</p>
        </div>
        <div class="info-card">
            <span class="info-tag">DUAL PROTOCOL</span>
            <div class="info-title">3. ì–‘ë©´ 5-5-5 ë¦¬í¬íŠ¸</div>
            <p class="info-text">ì¢‹ì•„í•˜ëŠ” ê²ƒì„ í•´ì£¼ëŠ” ê²ƒë³´ë‹¤, ì‹«ì–´í•˜ëŠ” ê²ƒì„ í•˜ì§€ ì•ŠëŠ” ê²Œ ë” ì¤‘ìš”í•©ë‹ˆë‹¤. ì‚¬ë‘ì„ ì±„ìš°ëŠ” ë²•(Green)ê³¼ ìƒì²˜ë¥¼ ë§‰ëŠ” ë²•(Red)ì„ ë™ì‹œì— ì œê³µí•©ë‹ˆë‹¤.</p>
        </div>

        <button class="btn-main" onclick="alert('í˜„ì¬ ë² íƒ€ ê¸°ê°„ìœ¼ë¡œ ë¬´ë£Œ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.')" style="background:#fff; color:#000; margin-bottom:10px;">í”„ë¦¬ë¯¸ì—„ ë¦¬í¬íŠ¸ êµ¬ë§¤í•˜ê¸°</button>
        
        <button class="btn-main" onclick="go('v-buyer-init')">ì´ë¯¸ êµ¬ë§¤í•˜ì…¨ë‚˜ìš”? (ì‹œì‘í•˜ê¸°)</button>
    </div>
</div>

<div class="app" id="v-buyer-init">
    <header>
        <span class="logo">INVITATION</span>
        <h1>ì†Œì¤‘í•œ ì‚¬ëŒì„<br>ì´ˆëŒ€í•´ ì£¼ì„¸ìš”</h1>
        <p class="desc">ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ íŒŒíŠ¸ë„ˆì—ê²Œ<br>ì´ˆëŒ€ì¥ì„ ë³´ë‚´ì„¸ìš”.</p>
    </header>
    <div style="padding: 20px;">
        <div style="background:#111; padding:20px; border-radius:12px; text-align:center; margin-bottom:20px; color:#fff;">
            ğŸ« <b>ì´ˆëŒ€ ë§í¬ ìƒì„± ì™„ë£Œ</b><br>
            <span style="font-size:0.8rem; color:var(--sub);">ìƒëŒ€ë°©ì€ ê²°ê³¼ë¥¼ ë³¼ ìˆ˜ ì—†ìœ¼ë©°,<br>ë°ì´í„°ëŠ” ì•”í˜¸í™”ë˜ì–´ ë‹¹ì‹ ì—ê²Œë§Œ ë„ì°©í•©ë‹ˆë‹¤.</span>
        </div>
        <button class="btn-kakao" onclick="copyInvite()">ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ì´ˆëŒ€ì¥ ë³´ë‚´ê¸°</button>
    </div>
</div>

<div class="app" id="v-guest">
    <header>
        <span class="logo">DEEP LOVE</span>
        <h1>ë‹¹ì‹ ì„ ë” ê¹Šì´ ì‚¬ë‘í•˜ê¸° ìœ„í•œ<br>ì§ˆë¬¸ì…ë‹ˆë‹¤.</h1>
        <p class="desc">ì •ë‹µì€ ì—†ìŠµë‹ˆë‹¤.<br>ë‹¹ì‹ ì˜ ê°ê°ì´ ì´ë„ëŠ” ëŒ€ë¡œ ì„ íƒí•´ ì£¼ì„¸ìš”.</p>
    </header>
    <div style="padding: 20px;">
        <button class="btn-main" onclick="startSurvey()">ì§ˆë¬¸ ì‹œì‘í•˜ê¸°</button>
    </div>
</div>

<div class="app" id="v-survey">
    <div class="progress-bar"><div class="progress-fill" id="p-fill"></div></div>
    <div style="padding: 30px 20px; flex: 1; display: flex; flex-direction: column; justify-content: center;">
        <div id="q-num" style="color:var(--accent); font-weight:800; font-size:0.9rem; margin-bottom:20px;">QUESTION 01</div>
        <div id="q-text" style="font-size:1.4rem; font-weight:700; margin-bottom:40px; color:#fff; line-height:1.4;"></div>
        <div id="opt-box"></div>
    </div>
    <div style="padding:20px; text-align:center;">
        <button onclick="prevQ()" style="background:none; border:none; color:var(--sub); text-decoration:underline; cursor:pointer;">&lt; ì´ì „ìœ¼ë¡œ</button>
    </div>
</div>

<div class="app" id="v-seal">
    <div style="flex:1; display:flex; flex-direction:column; justify-content:center; align-items:center; padding:20px; text-align:center;">
        <div style="font-size:3rem; margin-bottom:20px;">ğŸ’Œ</div>
        <h2>ë§ˆìŒì´ ë´‰ì¸ë˜ì—ˆìŠµë‹ˆë‹¤</h2>
        <p class="desc" style="margin-top:10px;">
            ì†”ì§í•œ ë‹µë³€ ê°ì‚¬í•©ë‹ˆë‹¤.<br>
            ì´ ë°ì´í„°ëŠ” ì˜¤ì§ ë‹¹ì‹ ì„ ì•„ê»´ì¤„<br>
            ë‹¨ í•œ ì‚¬ëŒì—ê²Œë§Œ ì „ë‹¬ë©ë‹ˆë‹¤.
        </p>
        <div id="key-area" style="width:100%; display:none; animation:fadeIn 1s;">
            <button class="btn-kakao" onclick="sendKey()">ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ê²°ê³¼ ë³´ë‚´ê¸°</button>
        </div>
    </div>
</div>

<div class="app" id="v-report">
    <header style="padding-bottom:10px;">
        <span class="logo">LOVE REPORT</span>
        <h1>ìƒëŒ€ë°© ì‚¬ìš© ì„¤ëª…ì„œ</h1>
    </header>
    
    <div style="padding: 20px;">
        <div style="position:relative; height:260px; margin-bottom:10px;">
            <canvas id="radarChart"></canvas>
        </div>
        <p style="text-align:center; color:var(--accent); font-size:0.9rem; margin-bottom:30px; font-weight:700;">
            TYPE: <span id="type-name">ë¶„ì„ ì¤‘...</span>
        </p>

        <div class="zone-box" style="border-color:var(--accent);">
            <div class="zone-header">
                <span class="z-title green">ğŸŸ¢ ì‚¬ë‘ì„ ì±„ìš°ëŠ” ë²• (Green)</span>
            </div>
            <div id="green-list"></div>
        </div>

        <div class="zone-box" style="border-color:var(--love);">
            <div class="zone-header">
                <span class="z-title red">ğŸ”´ ìƒì²˜ë¥¼ ë§‰ëŠ” ë²• (Red)</span>
            </div>
            <div id="red-list"></div>
        </div>

        <div class="info-card" style="border-color:var(--love); background:rgba(255,0,85,0.05);">
            <div class="info-title red" style="font-size:0.9rem;">âš¡ ìˆ¨ê²¨ì§„ ë§ˆìŒ (Latency Tracker)</div>
            <p class="info-text" id="latency-msg" style="color:#ffcccc;"></p>
        </div>
        
        <div style="height:50px;"></div>
    </div>
</div>

<script>
    // --- [DATA] ì§ˆë¬¸ ë° ë¶„ì„ ë¡œì§ ---
    // ì‹¤ì œ 30ê°œ ë¬¸í•­ êµ¬ì¡° (ìƒ˜í”Œ 5ê°œ + ë°˜ë³µ ë¡œì§ìœ¼ë¡œ 30ê°œ êµ¬í˜„)
    const baseQuestions = [
        { q: "ì •ë§ ì§€ì¹œ ë‚ , ë‹¹ì‹ ì—ê²Œ ê°€ì¥ ìœ„ë¡œê°€ ë˜ëŠ” ê²ƒì€?", a: ["ë”°ëœ»í•œ í¬ì˜¹ê³¼ ì˜¨ê¸°", "ì™„ë²½í•œ í˜¼ìë§Œì˜ ì •ì ", "ë§›ìˆëŠ” ìŒì‹ê³¼ ì„ ë¬¼", "ì§„ì‹¬ ì–´ë¦° ì¸ì •ì˜ ë§", "í•´ê²°ì±…ê³¼ ì¡°ì–¸"], t: "R" },
        { q: "ë°ì´íŠ¸ ì¤‘ ì‹ë‹¹ì— ê°”ì„ ë•Œ ê°€ì¥ í¸ì•ˆí•œ ìë¦¬ëŠ”?", a: ["ë²½ì„ ë“±ì§„ êµ¬ì„ ìë¦¬", "ì°½ê°€ ìë¦¬", "ì‚¬ëŒë“¤ì´ ë³´ì´ëŠ” ìë¦¬", "ì¶œì…êµ¬ ê·¼ì²˜", "ì–´ë””ë“  ìƒê´€ì—†ìŒ"], t: "P" },
        { q: "ëˆ„êµ°ê°€ì™€ì˜ ëŒ€í™”ì—ì„œ ê°€ì¥ ìƒì²˜ë°›ëŠ” ìˆœê°„ì€?", a: ["ë‚´ ë§ì„ ëŠì„ ë•Œ", "ë¬´í‘œì •í•˜ê²Œ ë°˜ì‘í•  ë•Œ", "ëª©ì†Œë¦¬ê°€ ì»¤ì§ˆ ë•Œ", "ë…¼ë¦¬ì ìœ¼ë¡œ ë°˜ë°•í•  ë•Œ", "ë”´ì²­ì„ í”¼ìš¸ ë•Œ"], t: "S" },
        { q: "ì˜ˆìƒì¹˜ ëª»í•œ ë³€í™”(ì•½ì† ì·¨ì†Œ ë“±)ê°€ ìƒê¸°ë©´?", a: ["ë§¤ìš° ìŠ¤íŠ¸ë ˆìŠ¤ ë°›ìŒ", "ì¡°ê¸ˆ ë‹¹í™©í•˜ì§€ë§Œ ê´œì°®ìŒ", "ì˜¤íˆë ¤ ììœ ë¡œì›Œì„œ ì¢‹ìŒ", "í™”ê°€ ë‚¨", "ë‹¤ë¥¸ ê³„íšì„ ë°”ë¡œ ì„¸ì›€"], t: "P" },
        { q: "ë‹¹ì‹ ì´ ì‚¬ë‘ë°›ëŠ”ë‹¤ê³  ëŠë¼ëŠ” ìµœê³ ì˜ ìˆœê°„ì€?", a: ["ë‚˜ë¥¼ ì±™ê²¨ì¤„ ë•Œ(í–‰ë™)", "ì‚¬ë‘í•œë‹¤ê³  ë§í•´ì¤„ ë•Œ", "ë‚´ í¸ì„ ë“¤ì–´ì¤„ ë•Œ", "ë‚˜ë¥¼ ë¯¿ê³  ë§¡ê²¨ì¤„ ë•Œ", "í•¨ê»˜ ìˆì–´ì¤„ ë•Œ"], t: "E" }
    ];
    
    // 30ê°œë¡œ í™•ì¥ (ë°ëª¨ìš© ë³µì œ)
    let qData = [];
    for(let i=0; i<6; i++) qData = qData.concat(baseQuestions);

    // [DEEP LOVE LOGIC] ë¶„ì„ ê²°ê³¼ ë¼ì´ë¸ŒëŸ¬ë¦¬ (ë³´í¸ì  ì‚¬ë‘ì˜ ê¸°ìˆ )
    const analysisDB = {
        P: { // í†µì œ/ì•ˆì „ ì¶”êµ¬í˜•
            name: "ì•ˆì „ê¸°ì§€ ì¶”êµ¬í˜• (Safety Seeker)",
            green: [
                { k: "ì˜ˆì¸¡ ê°€ëŠ¥ì„±", g: "â–®â–®â–®â–®â–®", act: "ë°ì´íŠ¸ ì „ ë™ì„ ì„ ë¯¸ë¦¬ ê³µìœ í•´ì£¼ì„¸ìš”. ê·¸ëŠ” ë¨¸ë¦¿ì†ì— ì§€ë„ê°€ ê·¸ë ¤ì ¸ì•¼ ì•ˆì‹¬í•©ë‹ˆë‹¤.", msg: "ì˜¤ëŠ˜ ê³„íšì€ Aë‘ B ì¤€ë¹„í–ˆì–´. ë„¤ê°€ í¸í•œ ê±¸ë¡œ ê³¨ë¼." },
                { k: "ì„ íƒê¶Œ ì¡´ì¤‘", g: "â–®â–®â–®â–®â–¯", act: "'ì•„ë¬´ê±°ë‚˜'ëŠ” ê¸ˆë¬¼. í•­ìƒ 2ê°€ì§€ ì´ìƒì˜ ë³´ê¸°ë¥¼ ì£¼ê³  ê·¸ê°€ ì§ì ‘ ê³ ë¥´ê²Œ í•˜ì„¸ìš”.", msg: "í•œì‹ì´ë‘ ì¼ì‹ ì¤‘ì— ë­ê°€ ë” ë‹¹ê²¨?" },
                { k: "ê³µê°„ì  ì•ˆì „", g: "â–®â–®â–®â–®â–®", act: "ì‹ë‹¹ì—ì„œëŠ” ë¬´ì¡°ê±´ ë²½ì„ ë“±ì§„ êµ¬ì„ ìë¦¬ì— ì•‰íˆì„¸ìš”. ë°°í›„ê°€ ì•ˆì „í•´ì•¼ ë§ˆìŒì„ ì—½ë‹ˆë‹¤.", msg: "ì•ˆìª½ ì¡°ìš©í•œ ìë¦¬ë¡œ ì¡ì•˜ì–´." },
                { k: "ì•½ì†ì˜ ì´í–‰", g: "â–®â–®â–®â–¯â–¯", act: "ì‹œê°„ ì•½ì†ì€ ì¹¼ê°™ì´ ì§€í‚¤ì„¸ìš”. ëŠ¦ëŠ”ë‹¤ë©´ ë¶„ ë‹¨ìœ„ë¡œ ì •í™•íˆ ì•Œë ¤ì¤˜ì•¼ í•©ë‹ˆë‹¤.", msg: "5ë¶„ ì •ë„ ëŠ¦ì„ ê²ƒ ê°™ì•„. ë¯¸ì•ˆí•´." },
                { k: "ì¼ê´€ì„±", g: "â–®â–®â–®â–¯â–¯", act: "ê°ì • ê¸°ë³µ ì—†ì´ ëŠ˜ ê·¸ ìë¦¬ì— ìˆëŠ” ë‚˜ë¬´ ê°™ì€ ëª¨ìŠµì„ ë³´ì—¬ì£¼ì„¸ìš”.", msg: "ê±±ì • ë§ˆ, ë‚´ê°€ ë‹¤ í•´ê²°í• ê²Œ." }
            ],
            red: [
                { k: "ê¹œì§ì‡¼", g: "â–®â–®â–®â–®â–®", act: "ì˜ˆê³  ì—†ëŠ” ë°©ë¬¸ì´ë‚˜ ì„œí”„ë¼ì´ì¦ˆëŠ” ê·¸ì—ê²Œ 'í­ë ¥'ì…ë‹ˆë‹¤. ì œë°œ ë¯¸ë¦¬ ë§í•´ì£¼ì„¸ìš”.", msg: "ì§€ê¸ˆ ì§‘ ì•ì´ì•¼. ë‚˜ì™€." },
                { k: "í†µë¡œ ì¢Œì„", g: "â–®â–®â–®â–®â–®", act: "ì‚¬ëŒë“¤ì´ ì¹˜ê³  ë‹¤ë‹ˆëŠ” í†µë¡œ ìª½ì— ì•‰íˆì§€ ë§ˆì„¸ìš”. ë°¥ ë¨¹ëŠ” ë‚´ë‚´ ë¶ˆì•ˆí•´í•©ë‹ˆë‹¤.", msg: "ìë¦¬ ì—†ëŠ”ë° ê·¸ëƒ¥ ì—¬ê¸° ì•‰ì." },
                { k: "ëª¨í˜¸í•¨", g: "â–®â–®â–®â–®â–¯", act: "ì• ë§¤í•˜ê²Œ ë§í•´ì„œ ê·¸ë¥¼ ì¶”ë¦¬í•˜ê²Œ ë§Œë“¤ì§€ ë§ˆì„¸ìš”. ëª…í™•í•œ ê²°ë¡ ë¶€í„° ë§í•˜ì„¸ìš”.", msg: "ê¸€ì„, ë‚˜ë„ ì˜ ëª¨ë¥´ê² ëŠ”ë°?" },
                { k: "ê¸‰ë°œì§„", g: "â–®â–®â–®â–¯â–¯", act: "ê°‘ìê¸° ê³„íšì„ ë°”ê¾¸ê±°ë‚˜ ì¶©ë™ì ìœ¼ë¡œ í–‰ë™í•˜ì§€ ë§ˆì„¸ìš”.", msg: "ìš°ë¦¬ ê·¸ëƒ¥ ì§€ê¸ˆ ë°”ë‹¤ ë³´ëŸ¬ ê°ˆê¹Œ?" },
                { k: "ë°©ê´€", g: "â–®â–®â–®â–¯â–¯", act: "ê²°ì •ì„ ê·¸ì—ê²Œ ì „ì ìœ¼ë¡œ ë– ë„˜ê¸°ì§€ ë§ˆì„¸ìš”. (ë³´ê¸°ëŠ” ì£¼ë˜, ë°©ì¹˜í•˜ì§€ ë§ ê²ƒ)", msg: "ë„¤ê°€ ì•Œì•„ì„œ í•´." }
            ]
        },
        R: { // íšŒë³µ/ë‚´ë©´í˜• (ê¸°ë³¸ê°’ìœ¼ë¡œ ì‚¬ìš©)
            name: "ë‚´ë©´ íšŒë³µí˜• (Inner Peace)",
            green: [
                { k: "íˆ¬ëª… ì¸ê°„", g: "â–®â–®â–®â–®â–®", act: "ê·€ê°€ ì§í›„ 15ë¶„ì€ ë§ì„ ê±¸ì§€ ë§ê³  íˆ¬ëª… ì¸ê°„ ì·¨ê¸‰í•˜ì„¸ìš”. ì—ë„ˆì§€ ì¶©ì „ ì‹œê°„ì…ë‹ˆë‹¤.", msg: "(ëˆˆì¸ì‚¬ë§Œ í•˜ê³  ì¡°ìš©íˆ ë¬¼ ê±´ë„¤ê¸°)" },
                { k: "ì €ìŒì˜ ìœ„ë¡œ", g: "â–®â–®â–®â–®â–¯", act: "ë¶ˆì•ˆí•´í•  ë• ë…¼ë¦¬ë³´ë‹¤ ë‚®ê³  ëŠë¦° ëª©ì†Œë¦¬ë¡œ 'ê´œì°®ì•„'ë¼ê³  ë§í•´ì£¼ì„¸ìš”.", msg: "ê´œì°®ì•„, ë³„ì¼ ì•„ë‹ˆì•¼." },
                { k: "ì¹¨ë¬µ ê³µìœ ", g: "â–®â–®â–®â–¯â–¯", act: "ëŒ€í™”ê°€ ëŠê²¨ë„ ì–´ìƒ‰í•´í•˜ì§€ ë§ˆì„¸ìš”. í•¨ê»˜ ìˆëŠ” ì¹¨ë¬µì„ í¸ì•ˆí•˜ê²Œ ë§Œë“¤ì–´ì£¼ì„¸ìš”.", msg: "ê·¸ëƒ¥ ê°™ì´ ìˆìœ¼ë‹ˆê¹Œ ì¢‹ë‹¤." },
                { k: "ê¸°ë‹¤ë¦¼", g: "â–®â–®â–®â–¯â–¯", act: "ì§ˆë¬¸í•˜ê³  ë‹µì´ ëŠ¦ì–´ë„ ì¬ì´‰í•˜ì§€ ë§ê³  ê°€ë§Œíˆ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.", msg: "ì²œì²œíˆ ìƒê°í•˜ê³  ë§í•´ì¤˜." },
                { k: "í˜¼ìë§Œì˜ ì‹œê°„", g: "â–®â–®â–®â–®â–®", act: "ê°€ë” í˜¼ì ë™êµ´ì— ë“¤ì–´ê°€ê³  ì‹¶ì–´ í•  ë•Œ, ì¿¨í•˜ê²Œ ë³´ë‚´ì£¼ì„¸ìš”.", msg: "í‘¹ ì‰¬ê³  ì¶©ì „ë˜ë©´ ì—°ë½í•´." }
            ],
            red: [
                { k: "ì¬ì´‰", g: "â–®â–®â–®â–®â–®", act: "ëŒ€ë‹µì„ ê°•ìš”í•˜ê±°ë‚˜ ë¹¨ë¦¬ ê²°ì •í•˜ë¼ê³  ë‹¥ë‹¬í•˜ì§€ ë§ˆì„¸ìš”.", msg: "ì™œ ëŒ€ë‹µì´ ì—†ì–´? ì‚¬ëŒ ë¬´ì‹œí•´?" },
                { k: "ê³ ìŒ/ì†ŒìŒ", g: "â–®â–®â–®â–®â–¯", act: "í° ì†Œë¦¬ë¡œ ì›ƒê±°ë‚˜ ì†Œë¦¬ì¹˜ì§€ ë§ˆì„¸ìš”. ì²­ê°ì  ìê·¹ì— ë§¤ìš° ì·¨ì•½í•©ë‹ˆë‹¤.", msg: "ì•¼!! ë‚´ ë§ ì¢€ ë“¤ì–´ë´!!" },
                { k: "ê°„ì„­", g: "â–®â–®â–®â–®â–¯", act: "í˜¼ì ìˆê³  ì‹¶ì–´ í•˜ëŠ”ë° 'ì™œ ê·¸ë˜, ë¬´ìŠ¨ ì¼ ìˆì–´?'ë¼ê³  ìºë¬»ì§€ ë§ˆì„¸ìš”.", msg: "ë‚˜í•œí…Œ í™”ë‚œ ê±° ìˆì–´? ì™œ ê·¸ë˜?" },
                { k: "ê³µê°œì  ì§€ì ", g: "â–®â–®â–®â–®â–®", act: "ë‚¨ë“¤ ì•ì—ì„œ ê·¸ë¥¼ ë©´ë°• ì£¼ê±°ë‚˜ ë†€ë¦¬ì§€ ë§ˆì„¸ìš”.", msg: "ì–˜ê°€ ì›ë˜ ì¢€ ì†Œì‹¬í•´ì„œ ê·¸ë˜ìš”." },
                { k: "í•´ê²°ì±… ê°•ìš”", g: "â–®â–®â–®â–¯â–¯", act: "ìœ„ë¡œê°€ í•„ìš”í•œë° 'ê·¸ë˜ì„œ ë„¤ê°€ ì˜ëª»í–ˆë„¤'ë¼ê³  ë¶„ì„í•˜ì§€ ë§ˆì„¸ìš”.", msg: "ë„¤ê°€ ì²˜ì‹ ì„ ì˜í–ˆì–´ì•¼ì§€." }
            ]
        }
    };
    
    // Default fallback
    Object.assign(analysisDB, { E: analysisDB.P, S: analysisDB.R }); 

    // --- [SYSTEM] ìƒíƒœ ê´€ë¦¬ ---
    let step = 0;
    let answers = []; // {idx, lat}
    let tStart = 0;

    // View Router
    function go(id) {
        document.querySelectorAll('.app').forEach(el => el.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        window.scrollTo(0,0);
    }

    // 1. ì´ˆëŒ€ ë§í¬ ë³µì‚¬ (êµ¬ë§¤ì)
    function copyInvite() {
        // ì‹¤ì œë¡œëŠ” ë„ë©”ì¸ ì£¼ì†Œ + ?mode=guest
        const url = window.location.href.split('?')[0] + "?mode=guest";
        // ì¹´ì¹´ì˜¤í†¡ ê³µìœ  í‰ë‚´ (í´ë¦½ë³´ë“œ ë³µì‚¬)
        navigator.clipboard.writeText(url).then(() => {
            alert("ğŸ”— ì´ˆëŒ€ ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.\nì¹´ì¹´ì˜¤í†¡ ì±„íŒ…ë°©ì— ë¶™ì—¬ë„£ê¸°(Paste) í•˜ì„¸ìš”.");
        });
    }

    // 2. ì„¤ë¬¸ ì‹œì‘ (ì‚¬ìš©ì)
    function startSurvey() {
        step = 0; answers = [];
        go('v-survey');
        renderQ();
    }

    function renderQ() {
        const q = qData[step];
        document.getElementById('q-num').innerText = `QUESTION ${String(step+1).padStart(2,'0')}`;
        document.getElementById('q-text').innerText = q.q;
        document.getElementById('p-fill').style.width = `${((step)/30)*100}%`;
        
        const box = document.getElementById('opt-box');
        box.innerHTML = '';
        tStart = performance.now(); // ì‹œê°„ ì¸¡ì • ì‹œì‘
        
        q.a.forEach((txt, i) => {
            const btn = document.createElement('button');
            btn.className = 'opt-btn';
            btn.innerText = txt;
            btn.onclick = () => next(i);
            box.appendChild(btn);
        });
    }

    function next(idx) {
        const lat = performance.now() - tStart;
        answers.push({ i: idx, lat: lat });
        step++;
        if(step < 30) renderQ(); // ì‹¤ì œ 30ê°œ
        else finish();
    }

    function prevQ() {
        if(step > 0) { step--; answers.pop(); renderQ(); }
    }

    // 3. ì™„ë£Œ ë° í‚¤ ìƒì„±
    function finish() {
        go('v-seal');
        setTimeout(() => {
            document.getElementById('key-area').style.display = 'block';
        }, 1500); // 1.5ì´ˆ ë´‰ì¸ ì• ë‹ˆë©”ì´ì…˜ í›„ ë²„íŠ¼ ë“±ì¥
    }

    function sendKey() {
        // ê°„ë‹¨í•œ ë°ì´í„° ì¸ì½”ë”© (ì„ íƒê°’+ìµœëŒ€ì§€ì—°ì¸ë±ìŠ¤)
        const choices = answers.map(a => a.i).join(''); 
        const maxLat = answers.reduce((max, cur, i) => cur.lat > max.val ? {val:cur.lat, idx:i} : max, {val:0, idx:0});
        
        const raw = `${choices}|${maxLat.idx}`;
        const key = btoa(raw); // Base64
        const url = window.location.href.split('?')[0] + "?key=" + key;
        
        navigator.clipboard.writeText(url).then(() => {
            alert("ğŸ”‘ ê²°ê³¼ ì—´ì‡ ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.\nì´ˆëŒ€í•´ ì¤€ ë¶„ì—ê²Œ ì¹´í†¡ìœ¼ë¡œ ë³´ë‚´ì£¼ì„¸ìš”.");
        });
    }

    // 4. ë¦¬í¬íŠ¸ ìƒì„± (êµ¬ë§¤ì)
    function renderReport(key) {
        try {
            const decoded = atob(key);
            const [choicesStr, latIdxStr] = decoded.split('|');
            const choices = choicesStr.split('').map(Number);
            const latIdx = Number(latIdxStr);
            
            // ì ìˆ˜ ê³„ì‚° (ë°ëª¨ ë¡œì§)
            let scores = { P:0, R:0, E:0, S:0 };
            choices.forEach((c, i) => {
                const type = qData[i].t || 'R';
                if(scores[type] !== undefined) scores[type]++;
            });
            
            // ìŠ¹ì íƒ€ì… ê²°ì •
            const winType = Object.keys(scores).reduce((a, b) => scores[a] > scores[b] ? a : b);
            const data = analysisDB[winType] || analysisDB.R;
            
            // UI ë°”ì¸ë”©
            document.getElementById('type-name').innerText = data.name;
            drawChart(scores);
            
            // Green List
            const gBox = document.getElementById('green-list');
            data.green.forEach(item => {
                gBox.innerHTML += `
                <div class="item-row">
                    <div class="item-head">
                        <span class="item-keyword"># ${item.k}</span>
                        <span class="thermo t-med">ì¤‘ìš”ë„ ${item.g}</span>
                    </div>
                    <div class="action-text">${item.act}</div>
                    <div class="msg-box" onclick="alert('ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤')">ğŸ’¬ "${item.msg}"</div>
                </div>`;
            });
            
            // Red List
            const rBox = document.getElementById('red-list');
            data.red.forEach(item => {
                rBox.innerHTML += `
                <div class="item-row">
                    <div class="item-head">
                        <span class="item-keyword" style="color:#ffcccc"># ${item.k}</span>
                        <span class="thermo t-high">ì¹˜ëª…ë„ ${item.g}</span>
                    </div>
                    <div class="action-text">${item.act}</div>
                    <div class="msg-box" style="border-left-color:var(--love)" onclick="alert('ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤')">ğŸ’¬ "${item.msg}"</div>
                </div>`;
            });

            // Latency Tracker
            const qTxt = qData[latIdx].q;
            document.getElementById('latency-msg').innerHTML = 
                `íŒŒíŠ¸ë„ˆëŠ” <b>"${qTxt}"</b> ì§ˆë¬¸ì—ì„œ ê°€ì¥ ì˜¤ë˜ ë§ì„¤ì˜€ìŠµë‹ˆë‹¤. ì´ ì£¼ì œëŠ” ê·¸ì—ê²Œ ë§ ëª» í•  ê³ ë¯¼ì´ë‚˜ ìƒì²˜ê°€ ìˆì„ ìˆ˜ ìˆìœ¼ë‹ˆ, ëŒ€í™”í•  ë•Œ ê°ë³„íˆ ë°°ë ¤í•´ ì£¼ì„¸ìš”.`;

        } catch(e) {
            alert("í‚¤ê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
            go('v-landing');
        }
    }

    // Chart.js (Neon Wireframe Style)
    function drawChart(sc) {
        const ctx = document.getElementById('radarChart').getContext('2d');
        new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['ì•ˆì „ì¶”êµ¬', 'ë‚´ë©´íšŒë³µ', 'ê°ê°ì˜ˆë¯¼', 'ì¸ì •ìš•êµ¬', 'ê³µê°ëŠ¥ë ¥'],
                datasets: [{
                    data: [sc.P*5, sc.R*5, sc.E*5, sc.S*5, 80], // ìŠ¤ì¼€ì¼ë§
                    backgroundColor: 'rgba(0,0,0,0)', // íˆ¬ëª… (Wireframe)
                    borderColor: '#00f2ff',
                    borderWidth: 2,
                    pointBackgroundColor: '#fff',
                    pointBorderColor: '#00f2ff',
                    pointRadius: 4
                }]
            },
            options: {
                scales: {
                    r: {
                        angleLines: { color: '#222' },
                        grid: { color: '#222' },
                        pointLabels: { color: '#888', font:{size:11} },
                        ticks: { display: false },
                        suggestedMin: 0, suggestedMax: 100
                    }
                },
                plugins: { legend: { display: false } }
            }
        });
    }

    // [INIT]
    window.onload = () => {
        const p = new URLSearchParams(window.location.search);
        if(p.get('key')) { go('v-report'); renderReport(p.get('key')); }
        else if(p.get('mode') === 'guest') { go('v-guest'); }
        else { go('v-landing'); }
    };

</script>
</body>
</html>
